import{r as f,j as p,m as e,c as ie,N as se,a as re,R as ce,H as le,b as ae}from"./vendor-11d3d1d8.js";(function(){const b=document.createElement("link").relList;if(b&&b.supports&&b.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))x(i);new MutationObserver(i=>{for(const u of i)if(u.type==="childList")for(const g of u.addedNodes)g.tagName==="LINK"&&g.rel==="modulepreload"&&x(g)}).observe(document,{childList:!0,subtree:!0});function m(i){const u={};return i.integrity&&(u.integrity=i.integrity),i.referrerPolicy&&(u.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?u.credentials="include":i.crossOrigin==="anonymous"?u.credentials="omit":u.credentials="same-origin",u}function x(i){if(i.ep)return;i.ep=!0;const u=m(i);fetch(i.href,u)}})();const ue=`#root{background-color:#fff;color:#ffffffde;color-scheme:light;font-family:Inter,Avenir,Helvetica,Arial,sans-serif;font-size:16px;font-synthesis:none;font-weight:400;height:100vh;line-height:24px;margin:0;padding:0;text-rendering:optimizeLegibility;width:100vw;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale;-webkit-text-size-adjust:100%}a{color:#646cff;font-weight:500;text-decoration:inherit}a:hover{color:#535bf2}body{display:flex;margin:0;min-height:100vh;min-width:320px;place-items:center}h1{font-size:3.2em;line-height:1.1}button{background-color:#1a1a1a;border:1px solid transparent;border-radius:8px;cursor:pointer;font-family:inherit;font-size:1em;font-weight:500;padding:.6em 1.2em;transition:border-color .25s}button:hover{border-color:#646cff}button:focus,button:focus-visible{outline:4px auto -webkit-focus-ring-color}@media (prefers-color-scheme:light){#root{background-color:#fff;color:#213547}a:hover{color:#747bff}button{background-color:#f9f9f9}}
`;const G="/assets/react-35ef61ed.svg",J="/vite.svg",de="/assets/plug3-f4b3698f.png",fe="/assets/plug2-fcde437e.png",ge="/assets/outlet-2a34fa6c.png",he="/assets/wallsocket-880de703.png",Q=f.createContext({theme:"light",setTheme:()=>{console.warn("no theme provider")}});function pe(L){const[b,m]=f.useState("light");return p.jsx(Q.Provider,{value:{theme:b,setTheme:m},children:L.children})}function me(){const{theme:L,setTheme:b}=f.useContext(Q),m=f.useRef(null),x=f.useRef(null),i=f.useRef({}),u=f.useRef(!1);f.useRef(!1);const g=f.useRef(e.Engine.create()),H=f.useRef(e.Runner.create()),h=f.useRef(null),[M,X]=f.useState({});f.useState(!1);function Y(){console.log("App mounted"),i.current={};const l=window.innerWidth,r=window.innerHeight;if(m.current&&m.current.children.length==0&&(console.log("Creating canvas"),h.current=e.Render.create({element:m.current,engine:g.current,options:{width:l,height:r,wireframes:!1,background:"transparent",showCollisions:!0,showVelocity:!0}})),h.current)console.log("Render created");else{console.log("Render not created");return}e.World.add(g.current.world,[e.Bodies.rectangle(-10,r/2,20,r*3,{isStatic:!0}),e.Bodies.rectangle(l/2,r+10,l,20,{isStatic:!0}),e.Bodies.rectangle(l+10,r/2,20,r*3,{isStatic:!0})]),e.Runner.run(H.current,g.current),e.Render.run(h.current);const w=1,v=2;function V(o,t,c){const a=e.Composites.stack(o,t,c,1,20,10,function(s,P){return e.Bodies.rectangle(s,P,50,20,{collisionFilter:{category:v,group:v}})}),n=e.Bodies.circle(o+50*c,t,40,{density:.001,label:Math.random().toString(36).substring(7),collisionFilter:{group:v,category:v,mask:-1}});return e.Composite.add(a,n),e.Composites.chain(a,.5,0,-.5,0,{stiffness:.4,length:40,render:{type:"line"}}),e.Composite.add(a,e.Constraint.create({bodyB:a.bodies[0],pointB:{x:-25,y:0},pointA:{x:a.bodies[0].position.x,y:a.bodies[0].position.y},stiffness:.5})),[a,n]}const d=e.Bodies.rectangle(l*9/10,r/2+95/2,130,200,{isStatic:!0,collisionFilter:{mask:w},frictionAir:.1}),F=e.Bodies.rectangle(d.position.x,d.position.y-45,40,40,{isStatic:!0,collisionFilter:{mask:v},label:"outlet1"}),W=e.Bodies.rectangle(d.position.x,d.position.y+45,40,40,{isStatic:!0,collisionFilter:{mask:v},label:"outlet2"});e.World.add(g.current.world,[F,W,d]);const[Z,_]=V(l/4,-300,r/80),[A,D]=V(l+300,r+100,7),U=[F,W],z=[Z,A],O=[_,D],T=[[D,W]];e.Composite.add(g.current.world,z);const S=e.Mouse.create(h.current.canvas),q=e.MouseConstraint.create(g.current,{mouse:S,constraint:{stiffness:.2,render:{visible:!0}}});e.Composite.add(g.current.world,q),h.current.mouse=S;const C=new Image(150,150);C.src=de,C.onload=()=>{h.current.textures[G]=C};const B=new Image(125,125);B.src=fe,B.onload=()=>{h.current.textures[G]=B};function ee(o,t){const c=o.bodies,a=o.bodies[o.bodies.length-1];if(i.current[a.label]){const j=o.bodies.length-2,y=o.bodies[j+1];t.drawImage(B,y.position.x-B.width/2,y.position.y-B.height/2,B.width,B.height)}for(let j=1;j<c.length;j+=1){const y=c[j-1],E=c[j],K={x:y.position.x+30*Math.cos(y.angle),y:y.position.y+30*Math.sin(y.angle)},$={x:E.position.x-30*Math.cos(E.angle),y:E.position.y-30*Math.sin(E.angle)};t.beginPath(),t.moveTo(y.position.x,y.position.y),t.bezierCurveTo(K.x,K.y,$.x,$.y,E.position.x,E.position.y),t.strokeStyle="black",t.lineWidth=20,t.stroke(),t.strokeStyle="white",t.lineWidth=16,t.stroke()}if(i.current[a.label])return;const n=o.bodies.length-1,s=o.bodies[n],P=s.angle;t.save(),t.translate(s.position.x,s.position.y),t.rotate(P),t.drawImage(C,-C.width/2,-C.height/2,C.width,C.height),t.restore()}const R=new Image(125,125);R.src=ge,R.onload=()=>{h.current.textures[J]=R};const k=new Image(275,275);k.src=he,k.onload=()=>{h.current.textures[J]=k};function te(o,t){o.drawImage(k,t.position.x-k.width/2,t.position.y-k.height/2,k.width,k.height)}function oe(o,t){o.drawImage(R,t.position.x-R.width/2,t.position.y-R.height/2,R.width,R.height)}function ne(o,t){var a,n;const c=o.bodies[o.bodies.length-1];return u.current?((a=e.Collision.collides(t,o.bodies[o.bodies.length-1]))==null?void 0:a.collided)??!1:(n=e.Collision.collides(t,o.bodies[o.bodies.length-1]))!=null&&n.collided?(console.log("Connected"),console.log("Checking connection",c.label,t.label,O),i.current[c.label]===t||(i.current[c.label]&&(console.log("Disconnecting"),t.collisionFilter.mask=v,e.Composite.remove(o,o.constraints[o.constraints.length-1])),i.current[c.label]=t,e.Body.setPosition(o.bodies[o.bodies.length-1],{x:t.position.x,y:t.position.y}),e.Composite.add(o,e.Constraint.create({bodyB:o.bodies[o.bodies.length-1],pointB:{x:0,y:0},pointA:{x:t.position.x,y:t.position.y},stiffness:.1})),t.collisionFilter.mask=w,u.current=!0,setTimeout(()=>{u.current=!1},1e3)),!0):(i.current[c.label]===t&&(console.log("Disconnected"),e.Composite.remove(o,o.constraints[o.constraints.length-1]),i.current[c.label]=null,t.collisionFilter.mask=v),!1)}let I={x:-1,y:-1};e.Events.on(g.current,"afterUpdate",function(){var t,c,a;const o=(t=x.current)==null?void 0:t.getContext("2d");if(o){if(T.length>0)for(let n=0;n<T.length;n++){const s=T[n][0],P=T[n][1];i.current[s.label]===P?T.splice(n,1):e.Body.setPosition(s,{x:s.position.x+(P.position.x-s.position.x)/2,y:s.position.y+(P.position.y-s.position.y)/2})}q.body==d?(I.x==-1&&I.y==-1&&(I={x:d.position.x-S.position.x,y:d.position.y-S.position.y}),console.log("Wall is being dragged",I),e.Body.setPosition(d,{x:S.position.x+I.x,y:S.position.y+I.y}),z.forEach(n=>{const s=n.bodies[n.bodies.length-1];i.current[s.label]&&(e.Body.setPosition(s,{x:i.current[s.label].position.x,y:i.current[s.label].position.y}),e.Composite.remove(n,n.constraints[n.constraints.length-1]),e.Composite.add(n,e.Constraint.create({bodyB:n.bodies[n.bodies.length-1],pointB:{x:0,y:0},pointA:{x:i.current[s.label].position.x,y:i.current[s.label].position.y},stiffness:.1})))})):I={x:-1,y:-1},e.Body.setAngle(d,0),e.Body.setPosition(F,{x:d.position.x,y:d.position.y-45}),e.Body.setPosition(W,{x:d.position.x,y:d.position.y+45}),(a=(c=x.current)==null?void 0:c.getContext("2d"))==null||a.clearRect(0,0,x.current.width,x.current.height),te(o,d),z.forEach(n=>{U.forEach(s=>{ne(n,s)})}),U.forEach(n=>{oe(o,n)}),z.forEach(n=>{ee(n,o)}),O.forEach(n=>{(n.position.x<0||n.position.x>l)&&(e.Body.setVelocity(n,{x:0,y:0}),e.Body.setPosition(n,{x:n.position.x+(l/2-n.position.x)/10,y:n.position.y})),(n.position.y<0||n.position.y>r)&&(e.Body.setVelocity(n,{x:0,y:0}),e.Body.setPosition(n,{x:n.position.x,y:n.position.y+(r/2-n.position.y)/10}))})}}),setTimeout(()=>{Object.keys(i.current).forEach(o=>{if(i.current[o]){console.log("Checking connection",O);const t=O.find(c=>c.label===o);console.log("Checking connection",o,t,i.current[o]),t===void 0&&delete i.current[o]}})},1e3)}function N(){console.log("Resizing canvas");const l=window.innerWidth,r=window.innerHeight;h.current.canvas.height=r,h.current.canvas.width=l,h.current.bounds.max.x=l,h.current.bounds.max.y=r;const w=x.current;w&&(w.setAttribute("width",l.toString()),w.setAttribute("height",r.toString()),w.style.width=l+"px",w.style.height=r+"px")}return f.useEffect(()=>(console.log("App mounted"),m.current&&(m.current.innerHTML="",Y()),setTimeout(()=>{N()},100),setInterval(()=>{X(Object.values(i.current).reduce((l,r)=>(r&&(l[r.label]=!0),l),{}))},100),window.addEventListener("resize",N),()=>{console.log("App unmounted"),m.current&&(m.current.innerHTML=""),i.current={},e.Runner.stop(H.current),e.World.clear(g.current.world,!1)}),[]),f.useEffect(()=>{M.outlet2?b("light"):b("dark"),console.log("Powered:",M)},[M]),p.jsxs("div",{className:ie("h-screen w-screen",L==="light"?"bg-white":"bg-black"),children:[p.jsx("div",{ref:m,className:"h-screen w-screen opacity-10"}),p.jsx("canvas",{ref:x,className:"absolute left-0 top-0 h-full w-full",style:{pointerEvents:"none"}}),M.outlet1&&p.jsx("div",{})]})}function xe(){return p.jsx(se,{children:p.jsx(pe,{children:p.jsx(me,{})})})}const ye={};re.createRoot(document.getElementById("root")).render(p.jsx(ce.StrictMode,{children:p.jsxs(le,{context:ye,children:[p.jsx(ae,{children:p.jsx("style",{children:ue})}),p.jsx(xe,{})]})}));
